# 二手车交易平台

基于Python Django框架开发的二手车管理系统，提供完整的二手车交易功能。

## 📋 目录
- [功能特性](#功能特性)
- [技术栈](#技术栈)
- [快速开始](#快速开始)
- [用户操作说明书](#用户操作说明书)
- [管理员操作指南](#管理员操作指南)
- [API接口文档](#api接口文档)
- [故障排除](#故障排除)
- [部署说明](#部署说明)
- [开发团队](#开发团队)
- [许可证](#许可证)
- [联系方式](#联系方式)

## 功能特性

### 用户功能模块
- ✅ 用户注册与登录（手机号、邮箱多种方式）
- ✅ 用户信息管理（基本信息修改、交易历史查询、收藏管理）
- ✅ AI智能车辆推荐

### 后台管理模块
- ✅ 品牌与类型录入管理（进口品牌、国产品牌、轿车、SUV等）
- ✅ 品牌与类型查询
- ✅ 用户与车辆审核机制

### 汽车信息管理
- ✅ 车辆基本信息录入（品牌、型号、年份、里程等）
- ✅ 车辆状态跟踪（在售、已售、维修等）
- ✅ AI智能定价与估值

### 卖家功能模块
- ✅ 卖家注册与认证
- ✅ 车辆上架与管理
- ✅ 交易订单管理

### 交易管理模块
- ✅ 订单生成与状态跟踪
- ✅ 在线即时通讯功能

## 技术栈

- **后端**: Python 3.8+, Django 4.2
- **前端**: HTML5, CSS3, JavaScript, Bootstrap 5
- **数据库**: SQLite3 (开发), 支持PostgreSQL/MySQL
- **AI功能**: 机器学习价格预测，智能推荐算法
- **实时通讯**: WebSocket (Channels)

## 项目结构

```
used_car_system/
├── used_car_system/          # 项目主配置
├── users/                    # 用户管理应用
├── cars/                     # 车辆管理应用
├── transactions/             # 交易管理应用
├── chat/                     # 聊天功能应用
├── ai_recommendation/        # AI推荐应用
├── templates/                # 前端模板
├── static/                  # 静态文件
├── media/                   # 媒体文件
└── requirements.txt         # 依赖包
```

## 安装和运行

### 1. 环境准备

```bash
# 克隆项目
git clone <repository-url>
cd used_car_system

# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
# Windows:
venv\Scripts\activate
# Linux/Mac:
source venv/bin/activate

# 安装依赖
pip install -r requirements.txt
```

### 2. 环境配置

```bash
# 复制环境变量文件
cp .env.example .env

# 编辑.env文件，配置数据库和API密钥
# SECRET_KEY=your-secret-key
# DEBUG=True
```

### 3. 数据库初始化

```bash
# 生成数据库迁移文件
python manage.py makemigrations

# 应用数据库迁移
python manage.py migrate

# 创建超级用户
python manage.py createsuperuser
```

### 4. 启动开发服务器

```bash
# 收集静态文件
python manage.py collectstatic

# 启动服务器
python manage.py runserver
```

访问 http://127.0.0.1:8000 查看网站
访问 http://127.0.0.1:8000/admin 进入管理后台

## 👤 用户操作说明书

### 1. 注册与登录

#### 新用户注册
1. 访问网站首页，点击右上角"注册"按钮
2. 选择注册方式：
   - **手机号注册**：输入手机号，获取验证码，设置密码
   - **邮箱注册**：输入邮箱地址，接收验证邮件，设置密码
3. 填写基本信息：用户名、真实姓名、联系方式
4. 阅读并同意用户协议，完成注册

#### 用户登录
1. 点击右上角"登录"按钮
2. 输入用户名/手机号/邮箱和密码
3. 可选择"记住我"功能，下次自动登录
4. 忘记密码可点击"找回密码"，通过邮箱或手机重置

### 2. 买家操作指南

#### 浏览车辆
1. **首页浏览**：查看推荐车辆、热门车辆
2. **分类筛选**：按品牌、价格、车龄、里程等条件筛选
3. **搜索功能**：输入关键词搜索特定车辆
4. **AI推荐**：系统根据浏览历史智能推荐车辆

#### 车辆详情查看
1. 点击车辆卡片查看详细信息
2. 查看车辆图片、配置参数、历史记录
3. 查看卖家信息和信誉评价
4. 使用AI价格评估功能查看合理价格范围

#### 收藏与关注
1. **收藏车辆**：点击心形图标收藏感兴趣的车辆
2. **关注卖家**：关注信誉良好的卖家
3. **收藏管理**：在个人中心查看和管理收藏列表

#### 联系卖家
1. **在线聊天**：点击"联系卖家"进入聊天界面
2. **预约看车**：通过聊天功能预约线下看车时间
3. **价格协商**：与卖家在线协商价格

#### 下单购买
1. **确认购买**：点击"立即购买"按钮
2. **填写订单**：确认车辆信息、价格、交付方式
3. **支付定金**：在线支付定金锁定交易
4. **线下交易**：按约定时间地点完成交易
5. **确认收货**：交易完成后确认收货并评价

### 3. 卖家操作指南

#### 卖家认证
1. 登录后进入个人中心，点击"成为卖家"
2. 提交实名认证信息：身份证、联系方式
3. 等待平台审核（1-3个工作日）
4. 审核通过后获得卖家权限

#### 发布车辆
1. **基本信息**：填写品牌、型号、年份、里程等
2. **车辆图片**：上传车辆外观、内饰、发动机等照片
3. **配置参数**：填写详细配置信息
4. **价格设置**：参考AI定价建议设置合理价格
5. **发布审核**：提交后等待平台审核

#### 车辆管理
1. **在售车辆**：查看和管理正在出售的车辆
2. **已售车辆**：查看历史交易记录
3. **下架车辆**：对已售或不再出售的车辆进行下架
4. **价格调整**：根据市场情况调整车辆价格

#### 订单管理
1. **新订单**：查看买家发起的购买意向
2. **订单处理**：接受或拒绝购买请求
3. **交易沟通**：与买家沟通交易细节
4. **订单完成**：确认交易完成并评价买家

### 4. 个人中心功能

#### 个人信息管理
- 修改基本信息：头像、昵称、联系方式
- 修改密码：定期更新账户密码
- 实名认证：完善实名信息

#### 交易记录
- 购买记录：查看所有购买订单
- 出售记录：查看所有出售订单
- 评价记录：查看买卖双方的评价

#### 消息中心
- 系统通知：接收平台重要通知
- 交易消息：查看交易相关的消息
- 客服消息：与平台客服沟通

## 👨‍💼 管理员操作指南

### 1. 后台登录
1. 访问 `/admin` 路径
2. 输入管理员账号和密码
3. 进入管理后台界面

### 2. 用户管理

#### 用户审核
1. **新用户审核**：审核新注册用户的真实性
2. **卖家认证**：审核卖家提交的认证信息
3. **用户封禁**：对违规用户进行封禁处理

#### 用户信息管理
1. **用户查询**：按条件搜索和查看用户信息
2. **信息修改**：协助用户修改基本信息
3. **权限管理**：设置用户权限等级

### 3. 车辆管理

#### 车辆审核
1. **新车审核**：审核卖家发布的车辆信息
2. **信息核实**：核实车辆信息的真实性
3. **违规处理**：对违规车辆进行下架处理

#### 车辆分类管理
1. **品牌管理**：添加、编辑、删除车辆品牌
2. **类型管理**：管理车辆类型分类
3. **参数配置**：配置车辆参数选项

### 4. 交易监控

#### 订单管理
1. **订单查看**：查看所有交易订单
2. **异常处理**：处理交易异常情况
3. **纠纷调解**：调解买卖双方纠纷

#### 交易统计
1. **数据统计**：统计交易量、成交率等数据
2. **报表生成**：生成交易统计报表
3. **趋势分析**：分析交易趋势和市场变化

### 5. 系统配置

#### 基础设置
1. **网站配置**：设置网站名称、Logo等
2. **邮件配置**：配置邮件服务器设置
3. **短信配置**：配置短信服务商

#### 安全设置
1. **权限配置**：设置不同角色的权限
2. **日志管理**：查看系统操作日志
3. **备份恢复**：定期备份系统数据

## 主要功能说明

### 用户注册登录
- 支持用户名、邮箱、手机号多种登录方式
- 密码加密存储，确保安全性
- 用户类型分为买家、卖家、管理员

### 车辆管理
- 完整的车辆信息录入界面
- 支持多图片上传
- 车辆状态实时跟踪
- AI智能定价建议

### 交易系统
- 完整的订单生命周期管理
- 多种支付方式支持
- 买卖双方评价系统

### AI推荐功能
- 基于用户行为的智能推荐
- 机器学习价格预测
- 个性化车辆匹配

### 实时聊天
- 买卖双方即时通讯
- 交易相关聊天室
- 客服支持功能

## API接口

### 车辆相关API
- `GET /api/cars/` - 获取车辆列表
- `GET /api/cars/{id}/` - 获取车辆详情
- `POST /api/cars/{id}/favorite/` - 收藏/取消收藏车辆

### 用户相关API
- `GET /api/users/profile/` - 获取用户资料
- `PUT /api/users/profile/` - 更新用户资料
- `GET /api/users/favorites/` - 获取收藏列表

### AI推荐API
- `POST /api/ai/recommendations/` - 获取AI推荐
- `GET /api/ai/price-prediction/{car_id}/` - 价格预测

## 管理后台

管理后台提供完整的数据管理功能：
- 用户管理
- 车辆审核
- 交易监控
- 系统配置

访问 `/admin` 使用超级用户账号登录。

## 🛠️ 故障排除

### 常见问题及解决方案

#### 1. 安装依赖失败
**问题**: `pip install -r requirements.txt` 失败
**解决方案**:
```bash
# 更新pip
python -m pip install --upgrade pip

# 使用国内镜像源
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple

# 或逐个安装
pip install Django==4.2.7
pip install Pillow==10.0.1
# ... 其他依赖
```

#### 2. 数据库迁移失败
**问题**: `python manage.py migrate` 报错
**解决方案**:
```bash
# 删除数据库文件（开发环境）
rm db.sqlite3

# 重新迁移
python manage.py makemigrations
python manage.py migrate

# 或重置迁移文件
find . -path "*/migrations/*.py" -not -name "__init__.py" -delete
find . -path "*/migrations/*.pyc" -delete
python manage.py makemigrations
python manage.py migrate
```

#### 3. 静态文件无法加载
**问题**: CSS/JS文件404错误
**解决方案**:
```bash
# 收集静态文件
python manage.py collectstatic

# 检查settings.py配置
STATIC_URL = '/static/'
STATICFILES_DIRS = [BASE_DIR / 'static']
STATIC_ROOT = BASE_DIR / 'staticfiles'
```

#### 4. 聊天功能无法使用
**问题**: WebSocket连接失败
**解决方案**:
1. 检查Channels配置是否正确
2. 确保Redis服务正常运行
3. 检查ASGI配置

#### 5. 图片上传失败
**问题**: 上传图片时报错
**解决方案**:
1. 检查media目录权限
2. 确认Pillow库正确安装
3. 检查文件大小限制设置

#### 6. 邮件发送失败
**问题**: 注册验证邮件无法发送
**解决方案**:
1. 检查邮箱配置（SMTP服务器、端口、密码）
2. 确认.env文件中的邮箱设置
3. 测试邮件发送功能

#### 7. 管理员后台无法访问
**问题**: /admin页面报错
**解决方案**:
1. 确认已创建超级用户
2. 检查用户权限设置
3. 查看Django日志文件

### 日志查看

#### Django日志位置
```bash
# 查看Django运行日志
tail -f logs/django.log

# 查看错误日志
tail -f logs/error.log
```

#### 调试模式
开发环境设置 `DEBUG=True` 查看详细错误信息
生产环境设置 `DEBUG=False` 并配置错误页面

### 性能优化建议

#### 数据库优化
1. 使用数据库索引优化查询性能
2. 定期清理过期数据
3. 使用数据库连接池

#### 缓存优化
1. 配置Redis缓存
2. 使用Django缓存框架
3. 设置合理的缓存过期时间

#### 静态文件优化
1. 使用CDN加速静态文件
2. 启用Gzip压缩
3. 配置浏览器缓存

## 部署说明

### 生产环境部署

1. 设置 `DEBUG=False`
2. 配置生产数据库（PostgreSQL推荐）
3. 配置静态文件服务
4. 设置域名和HTTPS
5. 配置WSGI服务器（Gunicorn + Nginx）

### Docker部署

```dockerfile
# Dockerfile示例
FROM python:3.9
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY . .
CMD ["gunicorn", "used_car_system.wsgi:application", "--bind", "0.0.0.0:8000"]
```

## 开发团队

- 项目经理：负责项目规划和进度管理
- 后端开发：Django框架开发和API设计
- 前端开发：界面设计和用户体验优化
- AI工程师：机器学习算法开发和优化

## 许可证

本项目采用MIT许可证。

## 联系方式

如有问题或建议，请联系：
- 邮箱：support@usedcar.com
- 电话：400-123-4567